#!/bin/sh

# $Id: install-gx-map.in,v 1.7 2003-07-17 22:18:50-07 kst Exp $
# $Source: /home/kst/gx-map-redacted/install-gx-map.in,v $

verbosely () {
    echo "% $@"
    "$@"
    if [ $? -ne 0 ] ; then exit 1 ; fi
}

INSTALL_DIR=%INSTALL_DIR%
BINDIR=$INSTALL_DIR/bin
SBINDIR=$INSTALL_DIR/sbin
LIBDIR=$INSTALL_DIR/lib
DATA_DIR=%DATA_DIR%

BIN_FILES="gx-map"
SBIN_FILES="gx-check-requests gx-gen-mapfile cacl/gx-check-cacl-index"
LIB_FILES="Gridmap_Utils.pm Gridmap_Valid_Mappings.pm"

for dir in $INSTALL_DIR $BINDIR $SBINDIR $LIBDIR ; do
    if [ ! -d $dir ] ; then
        verbosely mkdir -m 755 $dir
    fi
done

verbosely cp -f $BIN_FILES  $BINDIR/.
verbosely cp -f $SBIN_FILES $SBINDIR/.
verbosely cp -f $LIB_FILES  $LIBDIR/.

for dir in $DATA_DIR \
           $DATA_DIR/RCS \
	   $DATA_DIR/cache \
           $DATA_DIR/cacl \
           $DATA_DIR/cacl/RCS
do
    if [ ! -d $dir ] ; then
        verbosely mkdir -m 755 $dir
    fi
done

if [ ! -d $DATA_DIR/new-requests ] ; then
    verbosely mkdir -m 1733 $DATA_DIR/new-requests
fi

if [ ! -L $INSTALL_DIR/var ] ; then
    verbosely ln -s $DATA_DIR $INSTALL_DIR/var
fi
