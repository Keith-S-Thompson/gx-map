# $Id: bug-0009,v 1.1 2005-03-26 12:18:17-08 kst Exp $
# $Source: /home/kst/gx-map-redacted/bugs/bug-0009,v $

gx-map bug 0009
Date: Sat 2005-03-26
Severity: Med
Reported by: Keith Thompson <kst@sdsc.edu>
Version: 0.4.1
Title: Better tracebacks on errors

Summary:
Error messages from die() include the line number on which die()
was invoked, but not where it was called from.  This can make things
difficult to track down (for example, a number of functions in
Gridmap_Utils die on failure.

Suggested fix:
Add the Die_Handler function from die_handler_demo to Gridmap_Utils,
and let all programs set $SIG{__DIE__} to \&Gridmap_Utils::Die_Handler.
Note that gx-gen-mapfile already has its own Die_Handler that deletes
a temp file; add a registration function to allow Die_Handler to
perform specified actions:

    my $tmp_file = "/tmp/gx-gen-mapfile-" . time . "-$$";

    $SIG{__DIE__} = \&Gridmap_Utils::Die_Handler;
    Gridmap_Utils::Register_Die_Function sub { unlink $tmp_file };
